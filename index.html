import React, { useState } from 'react';
import { FileText, Download, Plus, Trash2, Briefcase, GraduationCap, Award, User } from 'lucide-react';

const ResumeBuilder = () => {
  const [showBuilder, setShowBuilder] = useState(false);
  const [resumeData, setResumeData] = useState({
    personalInfo: {
      fullName: '',
      email: '',
      phone: '',
      location: '',
      linkedin: '',
      website: ''
    },
    summary: '',
    experience: [],
    education: [],
    skills: []
  });

  const addExperience = () => {
    setResumeData({
      ...resumeData,
      experience: [...resumeData.experience, {
        id: Date.now(),
        title: '',
        company: '',
        location: '',
        startDate: '',
        endDate: '',
        current: false,
        description: ''
      }]
    });
  };

  const addEducation = () => {
    setResumeData({
      ...resumeData,
      education: [...resumeData.education, {
        id: Date.now(),
        degree: '',
        school: '',
        location: '',
        graduationDate: '',
        gpa: ''
      }]
    });
  };

  const addSkill = () => {
    setResumeData({
      ...resumeData,
      skills: [...resumeData.skills, { id: Date.now(), name: '' }]
    });
  };

  const removeExperience = (id) => {
    setResumeData({
      ...resumeData,
      experience: resumeData.experience.filter(exp => exp.id !== id)
    });
  };

  const removeEducation = (id) => {
    setResumeData({
      ...resumeData,
      education: resumeData.education.filter(edu => edu.id !== id)
    });
  };

  const removeSkill = (id) => {
    setResumeData({
      ...resumeData,
      skills: resumeData.skills.filter(skill => skill.id !== id)
    });
  };

  const updatePersonalInfo = (field, value) => {
    setResumeData({
      ...resumeData,
      personalInfo: { ...resumeData.personalInfo, [field]: value }
    });
  };

  const updateExperience = (id, field, value) => {
    setResumeData({
      ...resumeData,
      experience: resumeData.experience.map(exp =>
        exp.id === id ? { ...exp, [field]: value } : exp
      )
    });
  };

  const updateEducation = (id, field, value) => {
    setResumeData({
      ...resumeData,
      education: resumeData.education.map(edu =>
        edu.id === id ? { ...edu, [field]: value } : edu
      )
    });
  };

  const updateSkill = (id, value) => {
    setResumeData({
      ...resumeData,
      skills: resumeData.skills.map(skill =>
        skill.id === id ? { ...skill, name: value } : skill
      )
    });
  };

  const generatePDF = () => {
    const { jsPDF } = window.jspdf;
    const pdf = new jsPDF();
    const pageWidth = pdf.internal.pageSize.getWidth();
    const pageHeight = pdf.internal.pageSize.getHeight();
    const margin = 20;
    let y = margin;

    // Header with name
    pdf.setFontSize(24);
    pdf.setFont(undefined, 'bold');
    pdf.text(resumeData.personalInfo.fullName || 'Your Name', margin, y);
    y += 8;

    // Contact info
    pdf.setFontSize(10);
    pdf.setFont(undefined, 'normal');
    const contactInfo = [
      resumeData.personalInfo.email,
      resumeData.personalInfo.phone,
      resumeData.personalInfo.location,
      resumeData.personalInfo.linkedin,
      resumeData.personalInfo.website
    ].filter(Boolean).join(' | ');
    
    pdf.text(contactInfo, margin, y);
    y += 10;

    // Line separator
    pdf.setDrawColor(0, 0, 0);
    pdf.line(margin, y, pageWidth - margin, y);
    y += 8;

    // Professional Summary
    if (resumeData.summary) {
      pdf.setFontSize(14);
      pdf.setFont(undefined, 'bold');
      pdf.text('PROFESSIONAL SUMMARY', margin, y);
      y += 6;
      
      pdf.setFontSize(10);
      pdf.setFont(undefined, 'normal');
      const summaryLines = pdf.splitTextToSize(resumeData.summary, pageWidth - 2 * margin);
      pdf.text(summaryLines, margin, y);
      y += summaryLines.length * 5 + 5;
    }

    // Experience
    if (resumeData.experience.length > 0) {
      pdf.setFontSize(14);
      pdf.setFont(undefined, 'bold');
      pdf.text('EXPERIENCE', margin, y);
      y += 6;

      resumeData.experience.forEach(exp => {
        if (y > pageHeight - 40) {
          pdf.addPage();
          y = margin;
        }

        pdf.setFontSize(11);
        pdf.setFont(undefined, 'bold');
        pdf.text(exp.title || 'Job Title', margin, y);
        y += 5;

        pdf.setFontSize(10);
        pdf.setFont(undefined, 'normal');
        const companyLine = `${exp.company || 'Company'} | ${exp.location || 'Location'} | ${exp.startDate || 'Start'} - ${exp.current ? 'Present' : exp.endDate || 'End'}`;
        pdf.text(companyLine, margin, y);
        y += 5;

        if (exp.description) {
          const descLines = pdf.splitTextToSize(exp.description, pageWidth - 2 * margin);
          pdf.text(descLines, margin, y);
          y += descLines.length * 5 + 3;
        }
        y += 2;
      });
      y += 3;
    }

    // Education
    if (resumeData.education.length > 0) {
      if (y > pageHeight - 40) {
        pdf.addPage();
        y = margin;
      }

      pdf.setFontSize(14);
      pdf.setFont(undefined, 'bold');
      pdf.text('EDUCATION', margin, y);
      y += 6;

      resumeData.education.forEach(edu => {
        if (y > pageHeight - 30) {
          pdf.addPage();
          y = margin;
        }

        pdf.setFontSize(11);
        pdf.setFont(undefined, 'bold');
        pdf.text(edu.degree || 'Degree', margin, y);
        y += 5;

        pdf.setFontSize(10);
        pdf.setFont(undefined, 'normal');
        const eduLine = `${edu.school || 'School'} | ${edu.location || 'Location'} | ${edu.graduationDate || 'Graduation Date'}${edu.gpa ? ' | GPA: ' + edu.gpa : ''}`;
        pdf.text(eduLine, margin, y);
        y += 7;
      });
      y += 3;
    }

    // Skills
    if (resumeData.skills.length > 0 && resumeData.skills.some(s => s.name)) {
      if (y > pageHeight - 30) {
        pdf.addPage();
        y = margin;
      }

      pdf.setFontSize(14);
      pdf.setFont(undefined, 'bold');
      pdf.text('SKILLS', margin, y);
      y += 6;

      pdf.setFontSize(10);
      pdf.setFont(undefined, 'normal');
      const skillsText = resumeData.skills.filter(s => s.name).map(s => s.name).join(' â€¢ ');
      const skillsLines = pdf.splitTextToSize(skillsText, pageWidth - 2 * margin);
      pdf.text(skillsLines, margin, y);
    }

    pdf.save('resume.pdf');
  };

  if (!showBuilder) {
    return (
      <div className="min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50">
        {/* Navigation */}
        <nav className="bg-white/80 backdrop-blur-sm border-b border-gray-200 sticky top-0 z-50">
          <div className="max-w-6xl mx-auto px-6 py-4 flex justify-between items-center">
            <div className="flex items-center gap-2">
              <FileText className="w-8 h-8 text-blue-600" />
              <span className="text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">
                ResumeForge
              </span>
            </div>
            <button
              onClick={() => setShowBuilder(true)}
              className="bg-blue-600 text-white px-6 py-2.5 rounded-lg font-semibold hover:bg-blue-700 transition-colors shadow-md hover:shadow-lg"
            >
              Get Started
            </button>
          </div>
        </nav>

        {/* Hero Section */}
        <div className="max-w-6xl mx-auto px-6 pt-20 pb-16 text-center">
          <div className="inline-flex items-center gap-2 bg-blue-100 text-blue-700 px-4 py-2 rounded-full text-sm font-semibold mb-6">
            <Award className="w-4 h-4" />
            Professional Resume Builder
          </div>
          
          <h1 className="text-6xl font-bold mb-6 bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 bg-clip-text text-transparent leading-tight">
            Build Your Perfect Resume
            <br />
            In Minutes
          </h1>
          
          <p className="text-xl text-gray-600 mb-10 max-w-2xl mx-auto leading-relaxed">
            Create a professional, ATS-friendly resume with our intuitive builder. 
            Stand out from the crowd and land your dream job.
          </p>

          <button
            onClick={() => setShowBuilder(true)}
            className="bg-gradient-to-r from-blue-600 to-purple-600 text-white px-8 py-4 rounded-xl font-bold text-lg hover:shadow-2xl transition-all transform hover:-translate-y-1 inline-flex items-center gap-2"
          >
            <FileText className="w-5 h-5" />
            Start Building Now - It's Free
          </button>
        </div>

        {/* Features */}
        <div className="max-w-6xl mx-auto px-6 py-16">
          <div className="grid md:grid-cols-3 gap-8">
            <div className="bg-white p-8 rounded-2xl shadow-lg hover:shadow-xl transition-shadow border border-gray-100">
              <div className="bg-blue-100 w-14 h-14 rounded-xl flex items-center justify-center mb-4">
                <User className="w-7 h-7 text-blue-600" />
              </div>
              <h3 className="text-xl font-bold mb-3">Easy to Use</h3>
              <p className="text-gray-600">
                Intuitive interface that guides you through each step. No design skills needed.
              </p>
            </div>

            <div className="bg-white p-8 rounded-2xl shadow-lg hover:shadow-xl transition-shadow border border-gray-100">
              <div className="bg-purple-100 w-14 h-14 rounded-xl flex items-center justify-center mb-4">
                <Briefcase className="w-7 h-7 text-purple-600" />
              </div>
              <h3 className="text-xl font-bold mb-3">Professional Design</h3>
              <p className="text-gray-600">
                Clean, modern templates that get noticed by recruiters and hiring managers.
              </p>
            </div>

            <div className="bg-white p-8 rounded-2xl shadow-lg hover:shadow-xl transition-shadow border border-gray-100">
              <div className="bg-pink-100 w-14 h-14 rounded-xl flex items-center justify-center mb-4">
                <Download className="w-7 h-7 text-pink-600" />
              </div>
              <h3 className="text-xl font-bold mb-3">Instant PDF Download</h3>
              <p className="text-gray-600">
                Download your resume as a professional PDF ready to send to employers.
              </p>
            </div>
          </div>
        </div>

        {/* CTA Section */}
        <div className="max-w-6xl mx-auto px-6 py-16 mb-16">
          <div className="bg-gradient-to-r from-blue-600 to-purple-600 rounded-3xl p-12 text-center text-white shadow-2xl">
            <h2 className="text-4xl font-bold mb-4">Ready to Get Started?</h2>
            <p className="text-xl mb-8 opacity-90">
              Join thousands of job seekers who've landed their dream jobs
            </p>
            <button
              onClick={() => setShowBuilder(true)}
              className="bg-white text-blue-600 px-8 py-4 rounded-xl font-bold text-lg hover:bg-gray-50 transition-colors inline-flex items-center gap-2 shadow-lg"
            >
              Create Your Resume Now
              <FileText className="w-5 h-5" />
            </button>
          </div>
        </div>
      </div>
    );
  }

  return (
    <div className="min-h-screen bg-gray-50">
      {/* Header */}
      <div className="bg-white border-b border-gray-200 sticky top-0 z-50 shadow-sm">
        <div className="max-w-5xl mx-auto px-6 py-4 flex justify-between items-center">
          <div className="flex items-center gap-2">
            <FileText className="w-6 h-6 text-blue-600" />
            <span className="text-xl font-bold text-gray-800">ResumeForge</span>
          </div>
          <button
            onClick={generatePDF}
            className="bg-blue-600 text-white px-6 py-2.5 rounded-lg font-semibold hover:bg-blue-700 transition-colors flex items-center gap-2 shadow-md"
          >
            <Download className="w-4 h-4" />
            Download PDF
          </button>
        </div>
      </div>

      {/* Form */}
      <div className="max-w-5xl mx-auto px-6 py-8">
        <div className="bg-white rounded-xl shadow-md p-8">
          {/* Personal Info */}
          <div className="mb-8">
            <h2 className="text-2xl font-bold mb-4 flex items-center gap-2 text-gray-800">
              <User className="w-6 h-6 text-blue-600" />
              Personal Information
            </h2>
            <div className="grid md:grid-cols-2 gap-4">
              <input
                type="text"
                placeholder="Full Name *"
                value={resumeData.personalInfo.fullName}
                onChange={(e) => updatePersonalInfo('fullName', e.target.value)}
                className="border border-gray-300 rounded-lg px-4 py-2.5 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"
              />
              <input
                type="email"
                placeholder="Email *"
                value={resumeData.personalInfo.email}
                onChange={(e) => updatePersonalInfo('email', e.target.value)}
                className="border border-gray-300 rounded-lg px-4 py-2.5 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"
              />
              <input
                type="tel"
                placeholder="Phone *"
                value={resumeData.personalInfo.phone}
                onChange={(e) => updatePersonalInfo('phone', e.target.value)}
                className="border border-gray-300 rounded-lg px-4 py-2.5 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"
              />
              <input
                type="text"
                placeholder="Location (City, State)"
                value={resumeData.personalInfo.location}
                onChange={(e) => updatePersonalInfo('location', e.target.value)}
                className="border border-gray-300 rounded-lg px-4 py-2.5 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"
              />
              <input
                type="text"
                placeholder="LinkedIn URL"
                value={resumeData.personalInfo.linkedin}
                onChange={(e) => updatePersonalInfo('linkedin', e.target.value)}
                className="border border-gray-300 rounded-lg px-4 py-2.5 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"
              />
              <input
                type="text"
                placeholder="Portfolio/Website"
                value={resumeData.personalInfo.website}
                onChange={(e) => updatePersonalInfo('website', e.target.value)}
                className="border border-gray-300 rounded-lg px-4 py-2.5 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"
              />
            </div>
          </div>

          {/* Summary */}
          <div className="mb-8">
            <h2 className="text-2xl font-bold mb-4 text-gray-800">Professional Summary</h2>
            <textarea
              placeholder="Write a brief summary of your professional background and key strengths..."
              value={resumeData.summary}
              onChange={(e) => setResumeData({ ...resumeData, summary: e.target.value })}
              rows={4}
              className="w-full border border-gray-300 rounded-lg px-4 py-2.5 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"
            />
          </div>

          {/* Experience */}
          <div className="mb-8">
            <div className="flex justify-between items-center mb-4">
              <h2 className="text-2xl font-bold flex items-center gap-2 text-gray-800">
                <Briefcase className="w-6 h-6 text-blue-600" />
                Work Experience
              </h2>
              <button
                onClick={addExperience}
                className="bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-blue-700 transition-colors flex items-center gap-2"
              >
                <Plus className="w-4 h-4" />
                Add Experience
              </button>
            </div>
            {resumeData.experience.map((exp) => (
              <div key={exp.id} className="border border-gray-200 rounded-lg p-6 mb-4 bg-gray-50">
                <div className="flex justify-end mb-3">
                  <button
                    onClick={() => removeExperience(exp.id)}
                    className="text-red-600 hover:text-red-700 flex items-center gap-1"
                  >
                    <Trash2 className="w-4 h-4" />
                  </button>
                </div>
                <div className="grid md:grid-cols-2 gap-4 mb-4">
                  <input
                    type="text"
                    placeholder="Job Title *"
                    value={exp.title}
                    onChange={(e) => updateExperience(exp.id, 'title', e.target.value)}
                    className="border border-gray-300 rounded-lg px-4 py-2.5 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none bg-white"
                  />
                  <input
                    type="text"
                    placeholder="Company *"
                    value={exp.company}
                    onChange={(e) => updateExperience(exp.id, 'company', e.target.value)}
                    className="border border-gray-300 rounded-lg px-4 py-2.5 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none bg-white"
                  />
                  <input
                    type="text"
                    placeholder="Location"
                    value={exp.location}
                    onChange={(e) => updateExperience(exp.id, 'location', e.target.value)}
                    className="border border-gray-300 rounded-lg px-4 py-2.5 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none bg-white"
                  />
                  <input
                    type="text"
                    placeholder="Start Date (e.g., Jan 2020)"
                    value={exp.startDate}
                    onChange={(e) => updateExperience(exp.id, 'startDate', e.target.value)}
                    className="border border-gray-300 rounded-lg px-4 py-2.5 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none bg-white"
                  />
                  <input
                    type="text"
                    placeholder="End Date (e.g., Dec 2022)"
                    value={exp.endDate}
                    onChange={(e) => updateExperience(exp.id, 'endDate', e.target.value)}
                    disabled={exp.current}
                    className="border border-gray-300 rounded-lg px-4 py-2.5 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none bg-white disabled:bg-gray-100"
                  />
                  <label className="flex items-center gap-2">
                    <input
                      type="checkbox"
                      checked={exp.current}
                      onChange={(e) => updateExperience(exp.id, 'current', e.target.checked)}
                      className="w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"
                    />
                    <span className="text-gray-700">Currently working here</span>
                  </label>
                </div>
                <textarea
                  placeholder="Describe your responsibilities and achievements..."
                  value={exp.description}
                  onChange={(e) => updateExperience(exp.id, 'description', e.target.value)}
                  rows={3}
                  className="w-full border border-gray-300 rounded-lg px-4 py-2.5 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none bg-white"
                />
              </div>
            ))}
          </div>

          {/* Education */}
          <div className="mb-8">
            <div className="flex justify-between items-center mb-4">
              <h2 className="text-2xl font-bold flex items-center gap-2 text-gray-800">
                <GraduationCap className="w-6 h-6 text-blue-600" />
                Education
              </h2>
              <button
                onClick={addEducation}
                className="bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-blue-700 transition-colors flex items-center gap-2"
              >
                <Plus className="w-4 h-4" />
                Add Education
              </button>
            </div>
            {resumeData.education.map((edu) => (
              <div key={edu.id} className="border border-gray-200 rounded-lg p-6 mb-4 bg-gray-50">
                <div className="flex justify-end mb-3">
                  <button
                    onClick={() => removeEducation(edu.id)}
                    className="text-red-600 hover:text-red-700 flex items-center gap-1"
                  >
                    <Trash2 className="w-4 h-4" />
                  </button>
                </div>
                <div className="grid md:grid-cols-2 gap-4">
                  <input
                    type="text"
                    placeholder="Degree *"
                    value={edu.degree}
                    onChange={(e) => updateEducation(edu.id, 'degree', e.target.value)}
                    className="border border-gray-300 rounded-lg px-4 py-2.5 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none bg-white"
                  />
                  <input
                    type="text"
                    placeholder="School/University *"
                    value={edu.school}
                    onChange={(e) => updateEducation(edu.id, 'school', e.target.value)}
                    className="border border-gray-300 rounded-lg px-4 py-2.5 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none bg-white"
                  />
                  <input
                    type="text"
                    placeholder="Location"
                    value={edu.location}
                    onChange={(e) => updateEducation(edu.id, 'location', e.target.value)}
                    className="border border-gray-300 rounded-lg px-4 py-2.5 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none bg-white"
                  />
                  <input
                    type="text"
                    placeholder="Graduation Date (e.g., May 2020)"
                    value={edu.graduationDate}
                    onChange={(e) => updateEducation(edu.id, 'graduationDate', e.target.value)}
                    className="border border-gray-300 rounded-lg px-4 py-2.5 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none bg-white"
                  />
                  <input
                    type="text"
                    placeholder="GPA (optional)"
                    value={edu.gpa}
                    onChange={(e) => updateEducation(edu.id, 'gpa', e.target.value)}
                    className="border border-gray-300 rounded-lg px-4 py-2.5 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none bg-white"
                  />
                </div>
              </div>
            ))}
          </div>

          {/* Skills */}
          <div className="mb-8">
            <div className="flex justify-between items-center mb-4">
              <h2 className="text-2xl font-bold flex items-center gap-2 text-gray-800">
                <Award className="w-6 h-6 text-blue-600" />
                Skills
              </h2>
              <button
                onClick={addSkill}
                className="bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-blue-700 transition-colors flex items-center gap-2"
              >
                <Plus className="w-4 h-4" />
                Add Skill
              </button>
            </div>
            <div className="grid md:grid-cols-3 gap-4">
              {resumeData.skills.map((skill) => (
                <div key={skill.id} className="flex gap-2">
                  <input
                    type="text"
                    placeholder="Skill name"
                    value={skill.name}
                    onChange={(e) => updateSkill(skill.id, e.target.value)}
                    className="flex-1 border border-gray-300 rounded-lg px-4 py-2.5 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"
                  />
                  <button
                    onClick={() => removeSkill(skill.id)}
                    className="text-red-600 hover:text-red-700"
                  >
                    <Trash2 className="w-5 h-5" />
                  </button>
                </div>
              ))}
            </div>
          </div>

          {/* Download Button */}
          <div className="flex justify-center pt-6">
            <button
              onClick={generatePDF}
              className="bg-gradient-to-r from-blue-600 to-purple-600 text-white px-8 py-3 rounded-lg font-bold text-lg hover:shadow-lg transition-all flex items-center gap-2"
            >
              <Download className="w-5 h-5" />
              Download Resume PDF
            </button>
          </div>
        </div>
      </div>
      
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    </div>
  );
};

export default ResumeBuilder;
